<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" type="text/css" href="css/account.css"/>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration Form</title>
</head>
<body>

    <div class="container">
        <div class="header">
            <h2>Create Account</h2>
        </div>
        <form id="form" class="form">
            <div class="form-control">
                <label for="username">Username</label>
                <input type="text" id="username" placeholder="johndoe123" autocomplete="off">
                <small>Error message</small>
            </div>

            <div class="form-control">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="john@example.com" autocomplete="off">
                <small>Error message</small>
            </div>

            <div class="form-control">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="********">
                <small>Error message</small>
            </div>

            <div class="form-control">
                <label for="check-password">Confirm Password</label>
                <input type="password" id="check-password" placeholder="********">
                <small>Error message</small>
            </div>

            <button type="submit" class="btn">Register</button>
        </form>
    </div>

    <script>
        const form = document.getElementById('form');
        const username = document.getElementById('username');
        const email = document.getElementById('email');
        const password = document.getElementById('password');
        const checkPassword = document.getElementById('check-password');

        form.addEventListener('submit', (e) => {
            e.preventDefault(); // Prevents the form from submitting to a server
            if (validateInputs()) {
                // Determine what happens if validation passes
                alert("Registration Successful!");
                // Here you would usually send data to backend using fetch/axios
                form.reset();
                resetClasses();
            }
        });

        const validateInputs = () => {
            const usernameValue = username.value.trim();
            const emailValue = email.value.trim();
            const passwordValue = password.value.trim();
            const checkPasswordValue = checkPassword.value.trim();
            let isValid = true;

            // Username Validation
            if(usernameValue === '') {
                setError(username, 'Username is required');
                isValid = false;
            } else if (usernameValue.length < 3) {
                setError(username, 'Username must be at least 3 characters');
                isValid = false;
            } else {
                setSuccess(username);
            }

            // Email Validation
            if(emailValue === '') {
                setError(email, 'Email is required');
                isValid = false;
            } else if (!isValidEmail(emailValue)) {
                setError(email, 'Provide a valid email address');
                isValid = false;
            } else {
                setSuccess(email);
            }

            // Password Validation
            if(passwordValue === '') {
                setError(password, 'Password is required');
                isValid = false;
            } else if (passwordValue.length < 8) {
                setError(password, 'Password must be at least 8 characters');
                isValid = false;
            } else {
                setSuccess(password);
            }

            // Confirm Password Validation
            if(checkPasswordValue === '') {
                setError(checkPassword, 'Please confirm your password');
                isValid = false;
            } else if (passwordValue !== checkPasswordValue) {
                setError(checkPassword, "Passwords doesn't match");
                isValid = false;
            } else {
                setSuccess(checkPassword);
            }

            return isValid;
        };

        const setError = (element, message) => {
            const inputControl = element.parentElement;
            const errorDisplay = inputControl.querySelector('small');

            errorDisplay.innerText = message;
            inputControl.className = 'form-control error';
        };

        const setSuccess = (element) => {
            const inputControl = element.parentElement;
            const errorDisplay = inputControl.querySelector('small');

            errorDisplay.innerText = '';
            inputControl.className = 'form-control success';
        };

        const resetClasses = () => {
             // Remove green/red borders after successful submit
             const controls = document.querySelectorAll('.form-control');
             controls.forEach(control => control.className = 'form-control');
        }

        const isValidEmail = (email) => {
            const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
            return re.test(String(email).toLowerCase());
        };
    </script>
</body>
</html>